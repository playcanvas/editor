editor.once('load', function () {
    'use strict';

    // returns skeleton script for a script with the specified url
    editor.method('sourcefiles:skeleton', function (url) {
        var parts = url.split('/');
        // remove .js extension
        var scriptName = parts[parts.length-1].slice(0,-3).replace(new RegExp("[\\.-]"), '_');
        var objectName = scriptName.charAt(0).toUpperCase() + scriptName.slice(1);

        var result = [
            "pc.script.create('" + scriptName + "', function (app) {",
            "    // Creates a new " + objectName + " instance",
            "    var " + objectName + " = function (entity) {",
            "        this.entity = entity;",
            "    };",
            "",
            "    " + objectName + ".prototype = {",
            "        // Called once after all resources are loaded and before the first update",
            "        initialize: function () {",
            "        },",
            "",
            "        // Called every frame, dt is time in seconds since last update",
            "        update: function (dt) {",
            "        }",
            "    };",
            "",
            "    return " + objectName + ";",
            "});"].join('\n');

        return result;
    });

    editor.method('sourcefiles:loadingScreen:skeleton', function () {
        return [
            "pc.script.createLoadingScreen(function (app) {",
            "    var showSplash = function () {",
            "        // splash",
            "        var splash = document.createElement('div');",
            "        splash.id = 'application-splash';",
            "        document.body.appendChild(splash);",
            "",
            "        var logo = document.createElement('img');",
            "        // replace with your logo",
            "        logo.src = 'http://static.playcanvas.com/images/logo/play.png';",
            "        splash.appendChild(logo);",
            "",
            "        // progress bar",
            "        var container = document.createElement('div');",
            "        container.id = 'progress-container';",
            "        splash.appendChild(container);",
            "",
            "        var bar = document.createElement('div');",
            "        bar.id = 'progress-bar';",
            "        container.appendChild(bar);",
            "    };",
            "",
            "    var hideSplash = function () {",
            "        var splash = document.getElementById('application-splash');",
            "        splash.parentElement.removeChild(splash);",
            "    };",
            "",
            "    var setProgress = function (value) {",
            "        var bar = document.getElementById('progress-bar');",
            "        if(bar) {",
            "            value = Math.min(1, Math.max(0, value));",
            "            bar.style.width = value * 100 + '%';",
            "        }",
            "    };",
            "",
            "    var createCss = function () {",
            "        var css = [",
            "            '#application-splash {',",
            "            '    position: absolute;',",
            "            '    top: 42%;',",
            "            '    width: 10%;',",
            "            '    left: 45%;',",
            "            '}',",
            "",
            "            '#application-splash img {',",
            "            '    width: 100%;',",
            "            '}',",
            "",
            "            '#progress-container {',",
            "            '    width: 100%;',",
            "            '    height: 2px;',",
            "            '    position: absolute;',",
            "            '    background-color: #444;',",
            "            '}',",
            "",
            "            '#progress-bar {',",
            "            '    width: 0%;',",
            "            '    height: 100%;',",
            "            '    background-color: white;',",
            "            '}'",
            "        ].join('\\n');",
            "",
            "        var style = document.createElement('style');",
            "        style.type = 'text/css';",
            "        if (style.styleSheet) {",
            "          style.styleSheet.cssText = css;",
            "        } else {",
            "          style.appendChild(document.createTextNode(css));",
            "        }",
            "",
            "        document.head.appendChild(style);",
            "    };",
            "",
            "",
            "    createCss();",
            "",
            "    showSplash();",
            "",
            "    app.on('preload:end', function () {",
            "        app.off('preload:progress');",
            "    });",
            "    app.on('preload:progress', setProgress);",
            "    app.on('start', hideSplash);",
            "});"
        ].join('\n');
    });
});